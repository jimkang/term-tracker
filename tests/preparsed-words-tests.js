/* global __dirname */

var runCommonCase = require('./run-common-case');

const storeFile = __dirname + '/fixtures/test.json';

var testCases = [
  {
    name: 'Initial state',
    createNewTrackerInTest: true,
    expectedSalientTerms: [],
    textProp: 'caption',
    docsToAdd: [
      {
        id: 'a',
        words: [
          'all',
          'three',
          'of',
          'these',
          'tailored',
          'to',
          'whatever',
          'your',
          'whatever',
          'your',
          'mattress',
          'needs',
          'are',
          'there',
          'all',
          'breathable',
          'so',
          'you',
          'can',
          'sleep',
          'cool',
          'keep',
          'a',
          'good',
          'temperature',
          'and',
          'as',
          'Jake',
          'alluded',
          'they',
          'all',
          'come',
          'in',
          'a',
          'little',
          'box',
          'that',
          'the',
          'mattress',
          'explodes',
          'out',
          'of',
          'with',
          'free',
          'shipping',
          'and',
          'returns',
          'in',
          'the',
          'United',
          'States',
          'of',
          'America',
          'and',
          'also',
          'Canada',
        ],
      },
    ],
  },
  {
    name: 'Add more records',
    createNewTrackerInTest: true,
    expectedSalientTerms: [
      { term: 'mattress', count: 2, countsInRefs: { a: 2 }, refs: ['a'] },
      { term: 'whatever', count: 2, countsInRefs: { a: 2 }, refs: ['a'] },
    ],
    expectedDocs: {
      b: {
        id: 'b',
        termCount: 16,
        countsPerTerm: {
          get: 1,
          application: 2,
          'didn\'t': 1,
          mean: 1,
          anything: 1,
          said: 1,
          acts: 1,
          less: 1,
          exhortation: 1,
          thumbs: 1,
          offer: 1,
          code: 1,
          $50: 1,
          mattress: 1,
          purchase: 1,
        },
      },
    },
    docsToAdd: [
      {
        id: 'b',
        words: [
          'get',
          'out',
          'that',
          'application',
          'was',
          'that',
          'it',
          'didn\'t',
          'mean',
          'anything',
          'what',
          'I',
          'just',
          'said',
          'is',
          'it',
          'acts',
          'less',
          'of',
          'an',
          'application',
          'and',
          'more',
          'of',
          'an',
          'exhortation',
          'thumbs',
          'with',
          'the',
          'offer',
          'code',
          'for',
          '$50',
          'off',
          'your',
          'mattress',
          'purchase',
        ],
      },
      {
        id: 'c',
        words: [
          'get',
          'out',
          'that',
          'application',
          'was',
          'that',
          'it',
          'didn\'t',
          'mean',
          'anything',
          'what',
          'I',
          'just',
          'said',
          'is',
          'it',
          'acts',
          'less',
          'of',
          'an',
          'application',
          'and',
          'more',
          'of',
          'an',
          'exhortation',
          'thumbs',
          'with',
          'the',
          'offer',
          'code',
          'for',
          '$50',
          'off',
          'your',
          'mattress',
          'purchase',
        ],
      },
    ],
  },
  {
    name: 'Reopening',
    createNewTrackerInTest: true,
    expectedSalientTerms: [
      {
        term: 'application',
        count: 4,
        countsInRefs: { b: 2, c: 2 },
        refs: ['b', 'c'],
      },
      {
        term: 'mattress',
        count: 4,
        countsInRefs: { a: 2, b: 1, c: 1 },
        refs: ['a', 'b', 'c'],
      },
      {
        term: 'less',
        count: 2,
        countsInRefs: { b: 1, c: 1 },
        refs: ['b', 'c'],
      },
      {
        term: 'acts',
        count: 2,
        countsInRefs: { b: 1, c: 1 },
        refs: ['b', 'c'],
      },
      {
        term: 'didn\'t',
        count: 2,
        countsInRefs: { b: 1, c: 1 },
        refs: ['b', 'c'],
      },
      {
        term: 'said',
        count: 2,
        countsInRefs: { b: 1, c: 1 },
        refs: ['b', 'c'],
      },
      {
        term: 'offer',
        count: 2,
        countsInRefs: { b: 1, c: 1 },
        refs: ['b', 'c'],
      },
      {
        term: 'code',
        count: 2,
        countsInRefs: { b: 1, c: 1 },
        refs: ['b', 'c'],
      },
      {
        term: 'mean',
        count: 2,
        countsInRefs: { b: 1, c: 1 },
        refs: ['b', 'c'],
      },
      { term: 'whatever', count: 2, countsInRefs: { a: 2 }, refs: ['a'] },
      {
        term: 'anything',
        count: 2,
        countsInRefs: { b: 1, c: 1 },
        refs: ['b', 'c'],
      },
      { term: 'get', count: 2, countsInRefs: { b: 1, c: 1 }, refs: ['b', 'c'] },
      { term: '$50', count: 2, countsInRefs: { b: 1, c: 1 }, refs: ['b', 'c'] },
      {
        term: 'purchase',
        count: 2,
        countsInRefs: { b: 1, c: 1 },
        refs: ['b', 'c'],
      },
      {
        term: 'thumbs',
        count: 2,
        countsInRefs: { b: 1, c: 1 },
        refs: ['b', 'c'],
      },
      {
        term: 'exhortation',
        count: 2,
        countsInRefs: { b: 1, c: 1 },
        refs: ['b', 'c'],
      },
    ],
    expectedDocs: {
      a: {
        id: 'a',
        termCount: 27,
        countsPerTerm: {
          three: 1,
          tailored: 1,
          whatever: 2,
          mattress: 2,
          needs: 1,
          breathable: 1,
          sleep: 1,
          cool: 1,
          keep: 1,
          good: 1,
          temperature: 1,
          jake: 1,
          alluded: 1,
          come: 1,
          little: 1,
          box: 1,
          explodes: 1,
          free: 1,
          shipping: 1,
          returns: 1,
          united: 1,
          states: 1,
          america: 1,
          also: 1,
          canada: 1,
        },
      },
      b: {
        id: 'b',
        termCount: 16,
        countsPerTerm: {
          get: 1,
          application: 2,
          'didn\'t': 1,
          mean: 1,
          anything: 1,
          said: 1,
          acts: 1,
          less: 1,
          exhortation: 1,
          thumbs: 1,
          offer: 1,
          code: 1,
          $50: 1,
          mattress: 1,
          purchase: 1,
        },
      },
      c: {
        id: 'c',
        termCount: 16,
        countsPerTerm: {
          get: 1,
          application: 2,
          'didn\'t': 1,
          mean: 1,
          anything: 1,
          said: 1,
          acts: 1,
          less: 1,
          exhortation: 1,
          thumbs: 1,
          offer: 1,
          code: 1,
          $50: 1,
          mattress: 1,
          purchase: 1,
        },
      },
    },
  },
];

testCases.forEach((testCase) => runCommonCase(testCase, { storeFile }));
